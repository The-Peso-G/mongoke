{"version":3,"sources":["webpack:///./src/docs/configuration.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"kfAMO,IAAMA,EAAe,Q,2MAE5B,IAKMC,EAAc,CAClBD,gBAEIE,EAAYC,IACH,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,E,oIACF,mBACD,OAAO,YAACJ,EAAD,KAAeD,EAAiBK,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAG5E,iBAAQ,CACN,GAAM,iBADR,iBAGA,oNACyE,0BAAYC,WAAW,KAAvB,eADzE,KAEA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,iBADZ,82BAkCL,iBAAQ,CACN,GAAM,SADR,SAGA,sBACE,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,WADQ,UAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,WADQ,UAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,YADQ,WAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,eADQ,cAGpB,kBAAIA,WAAW,MAAK,mBAAGA,WAAW,MAAS,CACvC,KAAQ,uBADQ,SAItB,iBAAQ,CACN,GAAM,SADR,SAGA,0IACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,oRAaL,iBAAQ,CACN,GAAM,cADR,cAGA,+EACA,iBAAQ,CACN,GAAM,WADR,WAGA,gIACA,iBAAQ,CACN,GAAM,YADR,YAGA,qFACA,iBAAQ,CACN,GAAM,kBADR,kBAGA,0PAGA,iBAAQ,CACN,GAAM,UADR,UAGA,sJACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,8FAML,iBAAQ,CACN,GAAM,QADR,QAGA,0PACA,iBAAQ,CACN,GAAM,cADR,cAGA,sKACA,sBACE,kBAAIA,WAAW,MAAf,+DACA,kBAAIA,WAAW,MAAf,4IAEF,iBAAQ,CACN,GAAM,YADR,YAGA,yJAAwI,0BAAYA,WAAW,KAAvB,WAAxI,8NAEA,iBAAQ,CACN,GAAM,aADR,aAGA,8FACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,gJAQL,iBAAQ,CACN,GAAM,QADR,QAGA,qEACA,iBAAQ,CACN,GAAM,MADR,MAGA,uDACA,iBAAQ,CACN,GAAM,SADR,SAGA,+CAA8B,0BAAYA,WAAW,KAAvB,QAA9B,wBAAuG,0BAAYA,WAAW,KAAvB,MAAvG,SACA,iBAAQ,CACN,GAAM,iBADR,iBAGA,iHACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,iBADZ,0FAWL,yGACA,uBAAK,sBAAMA,WAAW,OAAU,CAC5B,UAAa,iBADZ,6HAYL,iBAAQ,CACN,GAAM,SADR,SAGA,oKAAoJ,0BAAYA,WAAW,KAAvB,QAApJ,wKACuI,0BAAYA,WAAW,KAAvB,MADvI,gBAEA,iBAAQ,CACN,GAAM,qBADR,qBAGA,6HAA4G,0BAAYA,WAAW,KAAvB,UAA5G,0GAAyQ,0BAAYA,WAAW,KAAvB,YAAzQ,WACA,uBAAK,sBAAMA,WAAW,OAAU,IAA3B,iUAOL,iBAAQ,CACN,GAAM,YADR,YAGA,oMAEA,iBAAQ,CACN,GAAM,UADR,UAGA,gFACA,iBAAQ,CACN,GAAM,cADR,cAGA,oH,kMAKJJ,EAAWK,gBAAiB","file":"component---src-docs-configuration-md-ade2f674db33f147c372.js","sourcesContent":["import React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nimport DefaultLayout from \"/Users/morse/Documents/GitHub/mongoke/node_modules/gatsby-theme-docz/src/base/Layout.js\";\nexport const _frontmatter = {};\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"configuration\"\n    }}>{`Configuration`}</h1>\n    <p>{`Mongoke defines its entire configuration in a yaml file that can be used to generate the entire graphql server.\nThis configuration can be used inside the docker image in the default path `}<inlineCode parentName=\"p\">{`/config.yml`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-yml\"\n      }}>{`Configuration:\n    schema?: Str\n    schema_url?: Url\n    schema_path?: Str\n    types:\n        ...:\n            collection: Str\n            exposed?: Bool\n            pipeline?: [Any]\n            disambiguations?:\n                ...: Str\n            guards?: [\n                expression: Str\n                excluded?: [Str]\n                when?: \"after\" | \"before\"\n            ]\n    relations?: [\n        from: Str\n        to: Str\n        relation_type: \"to_many\" | \"to_one\"\n        field: Str\n        where: Any\n    ]\n    jwt?:\n        secret?: Str\n        header_name?: Str # default is \"Authorization\"\n        header_scheme?: Str # default is \"Bearer\"\n        required?: Bool\n        algorithms?: [\"H256\" | \"HS512\" | \"HS384\" | \"RS256\" | \"RS384\" | \"RS512\" | \"ES256\" | \"ES384\" | \"ES521\" | \"ES512\" | \"PS256\" | \"PS384\" | \"PS512\"]\n\nUrl: Str\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"index\"\n    }}>{`Index`}</h2>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Skema\"\n        }}>{`skema`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Types\"\n        }}>{`types`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Guards\"\n        }}>{`guards`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Relations\"\n        }}>{`relations`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"#Jwt-configuration\"\n        }}>{`jwt`}</a></li>\n    </ul>\n    <h1 {...{\n      \"id\": \"types\"\n    }}>{`Types`}</h1>\n    <p>{`Individual types config defined as an object where keys are the type names and values are the type configuration.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`types:\n    ...:\n        collection: Str\n        exposed?: Bool\n        pipeline?: [Any]\n        guards?: [\n            expression: Str\n            when?: \"after\" | \"before\"\n            excluded?: [Str]\n        ]\n        disambiguations?:\n            ...: Str\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"collection\"\n    }}>{`collection`}</h3>\n    <p>{`Defines to what collection the type is associated with`}</p>\n    <h3 {...{\n      \"id\": \"exposed\"\n    }}>{`exposed`}</h3>\n    <p>{`Defines if the type is exposed to graphql, useful when you whant to use certain types only as relations`}</p>\n    <h3 {...{\n      \"id\": \"pipeline\"\n    }}>{`pipeline`}</h3>\n    <p>{`custom mongodb pipeline to execute during the database query`}</p>\n    <h3 {...{\n      \"id\": \"disabiguations\"\n    }}>{`disabiguations`}</h3>\n    <p>{`necessary when querying a union type, to determine the actual type.\nit is an object where keys are type names and values are expressions.\nThe expressions are evaluated until one is found true and the right __type is applied`}</p>\n    <h1 {...{\n      \"id\": \"guards\"\n    }}>{`Guards`}</h1>\n    <p>{`List of expressions to limit the access of the type fields to only certain users, based on jwt payload and the document data.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`guards?: [\n    expression: Str\n    excluded?: [Str]\n    when?: \"after\" | \"before\"\n]\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"when\"\n    }}>{`when`}</h3>\n    <p>{`decides if you want to evaluate the expression before or after querying the database, if you use before you save resources but have access to only the user jwt (if any) and not to the document to decide if user is authorized `}</p>\n    <h3 {...{\n      \"id\": \"expression\"\n    }}>{`expression`}</h3>\n    <p>{`python expression that can evaluate to true if you want to give user access to the type, expression is evaluated in python and has access to `}</p>\n    <ul>\n      <li parentName=\"ul\">{`x: the current document, available only if using when=after`}</li>\n      <li parentName=\"ul\">{`jwt: the user jwt payload, can contain whatever you put inside it, by default extracted from the Authorization header and not verified.`}</li>\n    </ul>\n    <h3 {...{\n      \"id\": \"excluded\"\n    }}>{`excluded`}</h3>\n    <p>{`By default the guards give access to all the document fields, you can limit the fileds you give access to by putting them inside `}<inlineCode parentName=\"p\">{`exclude`}</inlineCode>{`.\nTo implement different levels of authorization with access to different fields you can use many guards where the most protected is the first so that the evaluation stops at the weakest permissions required possible.`}</p>\n    <h1 {...{\n      \"id\": \"relations\"\n    }}>{`Relations`}</h1>\n    <p>{`Defined as a list of configurations to add connections between types.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`relations?: [\n    from: Str\n    to: Str\n    relation_type: \"to_many\" | \"to_one\"\n    field: Str\n    where: Any # the mongodb query\n]\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"from\"\n    }}>{`from`}</h3>\n    <p>{`The type where the relation's field is added`}</p>\n    <h3 {...{\n      \"id\": \"to\"\n    }}>{`to`}</h3>\n    <p>{`The type the relation leads to`}</p>\n    <h3 {...{\n      \"id\": \"field\"\n    }}>{`field`}</h3>\n    <p>{`The field added to the `}<inlineCode parentName=\"p\">{`from`}</inlineCode>{` type to connect the `}<inlineCode parentName=\"p\">{`to`}</inlineCode>{` type`}</p>\n    <h3 {...{\n      \"id\": \"relation_type\"\n    }}>{`relation_type`}</h3>\n    <p>{`if \"to_one\" the field in graphql will be a simple type reference and can be queried with`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-gql\"\n      }}>{`{\n    owner {\n        email\n        pet {\n            name\n        }\n    }\n}\n`}</code></pre>\n    <p>{`If \"to_many\" the field will resolve to a connection and can be queried like this`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-gql\"\n      }}>{`{\n    zoo {\n        pets(first: 10) {\n            nodes {\n                name\n            }\n        }\n    }\n}\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"where\"\n    }}>{`where`}</h3>\n    <p>{`The mongodb where query to find the related documents, you can evaluate custom python code inside the \\${{ }} and have access to parent: the `}<inlineCode parentName=\"p\">{`from`}</inlineCode>{` document as a python dict.\nThe code inside \\${{ }} will be evaluated during every query that needs the relation and the evaluation result will be used to query the `}<inlineCode parentName=\"p\">{`to`}</inlineCode>{` collection.`}</p>\n    <h1 {...{\n      \"id\": \"jwt-configuration\"\n    }}>{`Jwt configuration`}</h1>\n    <p>{`Configure how to handle jwt authentication, by default the jwt is not verified, to verify it add the `}<inlineCode parentName=\"p\">{`secret`}</inlineCode>{` field with the secret used to sign the jwt. You can require a jwt for all the query fields adding the `}<inlineCode parentName=\"p\">{`required`}</inlineCode>{` field.`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`    jwt?:\n        secret?: Str\n        header_name?: Str # default is \"Authorization\"\n        header_scheme?: Str # default is \"Bearer\"\n        required?: Bool\n        algorithms?: [\"H256\" | \"HS512\" | \"HS384\" | \"RS256\" | \"RS384\" | \"RS512\" | \"ES256\" | \"ES384\" | \"ES521\" | \"ES512\" | \"PS256\" | \"PS384\" | \"PS512\"]\n`}</code></pre>\n    <h3 {...{\n      \"id\": \"required\"\n    }}>{`required`}</h3>\n    <p>{`if specified, only users with jwt signed with the right secret have access to the resources, needs secret to work.\nBy default the secret is not required and not verified.`}</p>\n    <h3 {...{\n      \"id\": \"secret\"\n    }}>{`secret`}</h3>\n    <p>{`Used when required is present to check if jwt is signed`}</p>\n    <h3 {...{\n      \"id\": \"algorithms\"\n    }}>{`algorithms`}</h3>\n    <p>{`A list of algotihtm to decode the jwt, to see the full list chech the python pyJwt library`}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}